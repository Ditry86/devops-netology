# Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."

 

## Как сдавать задания

 

Обязательными к выполнению являются задачи без указания звездочки. Их выполнение необходимо для получения зачета и диплома о профессиональной переподготовке.

 

Задачи со звездочкой (*) являются дополнительными задачами и/или задачами повышенной сложности. Они не являются обязательными к выполнению, но помогут вам глубже понять тему.

 

Домашнее задание выполните в файле readme.md в github репозитории. В личном кабинете отправьте на проверку ссылку на .md-файл в вашем репозитории.

 

Любые вопросы по решению задач задавайте в чате учебной группы.

 

---

 

## Важно!

 

Перед отправкой работы на проверку удаляйте неиспользуемые ресурсы.

Это важно для того, чтоб предупредить неконтролируемый расход средств, полученных в результате использования промокода.

 

Подробные рекомендации [здесь](https://github.com/netology-code/virt-homeworks/blob/virt-11/r/README.md)

 

---

 

## Задача 1

 

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

 

### **Ответ:**

 

Полная виртуализация - виртуализация машины на уровне аппаратных ресурсов. Управление виртуальными машинами (ВМ) и ресурсами происходят посредством гипервизора, который сам представляет собой операционную систему(ОС, уровень ядра). ВМ предоставляются выделенные аппаратные ресурсы машины (ядра процессора, память) как будто это физические процессор и пямять со своим адресным пространством, а для работы с переферией (устройства ввода-вывода, шины и подключенные к ним устройства) через унифицированные драйвера (для всех ВМ одинаковые), реальные же драйвера аппаратных ресурсов работают с гипервизором (ядром). Причем в ВМ установленные ОС "думают", что работают на уровне ядра, как будто они установлены на физическую машину.

 

Паравиртуализация - виртуализация аппаратных ресурсов машины, но посредством установленной ОС на этой машине (хосте). То есть гипервизор работает не на уровне ядра, а как модуль работающей ОС. ВМ могут работь с выделенными аппаратными ресурсами через реальные драйвера на хостовой ОС. При этом сами ОС внутри ВМ могут "знать" о том, что они работают не на уровне ядра (напрямую с аппаратными ресурсами).

 

Виртуализация на основе ОС (контейнеры) - виртуализация машины на уровне ОС, с предоставлением ресурсов ОС. Сами контейнеры предсталяют собой процессы (зачастую приложения, микросервисы) с выделенным закрытым окружением (пространством имен, квотами на пользование аппаратными ресурсами). При работе контейнеров хостовая ОС производит трасляцию адресов памяти, потоков процессов, имен устройств на свое общее пространство имен. При этом контейнеры могут работать друг с другом, как разные сервисы (приложения) на разных машинах (со своим установленным программным обеспечением, устройствами, окружением, адресами интерфейсов).

 

## Задача 2

 

Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

 

Организация серверов:

- физические сервера,

- паравиртуализация,

- виртуализация уровня ОС.

 

Условия использования:

- Высоконагруженная база данных, чувствительная к отказу.

- Различные web-приложения.

- Windows системы для использования бухгалтерским отделом.

- Системы, выполняющие высокопроизводительные расчеты на GPU.

 

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

 

### **Ответ**

 

| Организация серверов  | Условия использования | Обоснование |

| ------------- | ------------- | ------------- |

| физические сервера  | Высоконагруженная база данных, чувствительная к отказу. Системы, выполняющие высокопроизводительные расчеты на GPU | Для первого случая необходимы HA кластеры () с горячим резервом. Для второго применимы вычислительные кластеры (если требуются большие вычислительные мощности), либо распределенные вычислительные grid-системы  |

| паравиртуализация | Windows системы для использования бухгалтерским отделом. Системы, выполняющие высокопроизводительные расчеты на GPU  | Hyper-V + сервер терминалов + СХД. Виртуализация рабочих столов (удаленные раб. столы, частая практика), либо виртуализация приложения (v-aps) для работы бухг. приложения (1С) с одной сет. лицензией для многих пользоваетлей на одном физ. сервере + СХД. Для второго случая паравиртуализация возможно в связи с возможностью предоставления ВМ оригинальных драйверов для видеоадаптеров машины|

| виртуализация уровня ОС | Различные web-приложения  | Микросервисы (web-приложения), CI/CD на основе применения контейнеров, облачные сервисы |

 

## Задача 3

 

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

 

Сценарии:

 

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.

2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.

3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.

4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

 

### **Ответ**

 

1. Hiper-V (ядро (гипервизор) + ВМ, модул (роль) Hyper-V + ). Windows-based архитектура со своим балансировщиком нагрузки, репликациейданных, работы с СХД, резервное копирование snapshot'ов.

2.  Xen PV. "Легковесный" бемплатный гипревизор, со стабильной работой, благодаря статическому выделению аппаратных ресурсов самому гипервизору для работы (предотращение занятия всей памяти и мощностей процессора ВМ) и установкой ВМ из шаблонов.

3. KVM. Более стабилен с работой Windows-based ВМ. Open source решение. С применением virtio и qemu - производительность приближена к реальной (как на машине непосредственно). Больше реализаций драйверов для Windows ВМ.

4. Docker. Быстрое развертывание контейнеров для работы микросервисов (приложений) на одной платформе с разными рабочим окружением, пространством имен, выделенными аппаратными ресурсами.возможность изменения окружений для приложений внутри контейнеров "на лету" с применением инструментов автоматизации.

 

## Задача 4

 

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

 

### **Ответ**

Проблемы и риски:

1. Сложность обслуживания, увеличенные накладные расходы на обслуживание, как со стороны рабочего персонала, так и со стороны поддержки, обновления ПО, получения лицензий (в случае коммерческих продуктов). Риски с реализациев внутренних конфигураций виртуальных систем при смене персонала. 

2. Специализированные "узкие места" систем виртуализации, не дающие возможность реализации определенных задач. Риски, связанные с обновлением ПО систем виртуализации при выпуске новых версий. Например, добавление устройств на хостовые машины с разными системами виртуализации (драйверы, которые не поддерживаются гипервизором VMWare, но поддерживаются Hyper-V).

3. Сложность организации единой системы управления, мониторинга ВМ из-за разных платформ и систем виртуализации. Более сложная реализация автоматизации процессов управления, мониторинга ВМ.

4. Сложная, либо невозможная реализация миграции ВМ с одной системы виртуализации на другую. От сюда вытикают риски, связанные с отказоустойчивостью сервисов, построенных на гетерогенных системах.

6. Проблемы, сложность реализации совместного использования внешних ресурсов (СХД), сетевого соединения ВМ друг с другом.

 

Возможные решения:

1. Использовать гомогенные среды :) Привлечение "универсальных" (знающих все используемые системы виртуализации и аппаратные решения) специалистов более высокого класса. Комплексные решения от вендоров. Использование внешних СХД для полного бэкапа ПО систем виртуализации (гипервизор + конфигурации) и ВМ при обновлении.
2. Использование библиотек эмуляции для развертывания ВМ на "недружественных платформах". Использование универсальных драйверов. Использование протестированных готовых сборок ВМ для нужного гипервизора.
3. Использование готовых платных решений от вендоров. Автоматизация управления и мониторинга систем виртуализации и ВМ через API, прдоставляемые этими системами, или открытые сетевые протоколы. Использование стандартных шаблонов, паттернов для автоматизации процессов
4. Использование стандартизированных форматов образов ВМ. Конвертация образов ВМ при помощи решений от вендоров, либо сторонних продуктов.
5. Использование открытых протоколов, решений (open stack), дополнительного ПО, либо решения от вендоров.
6. Использование технологий (готовых решений) распределенных систем (OpenStack, Nebula)

С одной стороны гетерогенные среды дают возможность построения более гибких систем для решения задач, с другой стороны увеличивается риск нестабильной работы этих систем, большая сложноть настройки, сопровождения и управления данных систем, отсутствует возможности реализовать необходимы задачи из-за характерных ограничения используемых систем.
Использование решений на основе гетерогенных сред оправдано, по моему мнению, в следующих случаях:
1. При малом бюджете (незватка средств на приобретение дополнительных, либо новых лицензий ПО системы виртуализации), и малых аппаратных мошностях отдельных нодов и хостов, используя технологии распределенных вычислений получить единую систему с суммарной большой мощьностью для решения специальных задачь в узкой области применеия. К примеру распределенные вычислительные системы для расчетов сложных алгоритмов. grid-системы
2. Если в организацци по наследию досталось, или используется решение построенное на опреленных технологиях и продуктах от определенных вендоров, к примеру серверы приложений на Hyper-V. Но за неимением бюджета на покупку нового парка современных серверов и лицензий для продуктов от этих же вендоров необходимо увеличение производительности всей системы, добавление новых возможностей и решений, для этих целей разворачиваются платформы на других системах виртуализации (KVM).
3. Необходимо развертывание ВМ с приложениями, работающими только на определенных ОС, с определенными библиотеками, устройствами, и драйверами к ним, которые данный гипервизор не поддерживает. Приходится устанавливать ПО виртуализации других вендоров, или opensource на дополнительном оборудовании